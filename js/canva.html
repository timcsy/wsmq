<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draggable and Resizable Canvas with Fixed Aspect Ratio</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #canvasContainer {
            position: absolute;
            width: 200px;
            height: 200px;
            cursor: move;
        }
        canvas {
            width: 100%;
            height: 100%;
            background-color: lightgray;
        }
        .resizer {
            width: 10px;
            height: 10px;
            background: #333;
            position: absolute;
            right: 0;
            bottom: 0;
            cursor: se-resize;
        }
    </style>
</head>
<body>
    <div id="canvasContainer">
        <canvas id="canvas"></canvas>
        <div class="resizer"></div>
    </div>

    <script>
        const canvasContainer = document.getElementById('canvasContainer');
        const resizer = document.querySelector('.resizer');
        let isDragging = false;
        let isResizing = false;
        let startX, startY, initialX, initialY, initialWidth, initialHeight;
        const aspectRatio = 1; // 固定比例，例如1:1，或者改為其他值

        canvasContainer.addEventListener('mousedown', (e) => {
            if (e.target === resizer) {
                isResizing = true;
                startX = e.clientX;
                startY = e.clientY;
                initialWidth = canvasContainer.offsetWidth;
                initialHeight = canvasContainer.offsetHeight;
            } else {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                initialX = canvasContainer.offsetLeft;
                initialY = canvasContainer.offsetTop;
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;
                canvasContainer.style.left = initialX + dx + 'px';
                canvasContainer.style.top = initialY + dy + 'px';
            } else if (isResizing) {
                const dx = e.clientX - startX;
                const newWidth = initialWidth + dx;
                const newHeight = newWidth / aspectRatio;
                canvasContainer.style.width = newWidth + 'px';
                canvasContainer.style.height = newHeight + 'px';
                resizeCanvas();
            }
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            isResizing = false;
        });

        function resizeCanvas() {
            const canvas = document.getElementById('canvas');
            canvas.width = canvasContainer.clientWidth;
            canvas.height = canvasContainer.clientHeight;
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = 'blue';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // 初始化 canvas
        resizeCanvas();
    </script>
</body>
</html>
